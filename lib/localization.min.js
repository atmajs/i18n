!function(n,t){"use strict";var e,r;"undefined"==typeof exports||n!==exports&&null!=n||(e=r=global),null==e&&(e="undefined"==typeof window?global:window),null==r&&(r=n||e),e.$L=t(e,r),"undefined"!=typeof module&&(module.exports=global.$L)}(this,function(n){"use strict";function t(n,t,e){var r=t.exec(n);return r&&r[e]?r[e]:null}function e(){}function r(){return r=S(m()),r.apply(null,arguments)}function l(){return console.error('<localizer> In node env. please call $L.fromReq(req)("someKey")'),S(L[0])}var i=Array.prototype.slice,o=!("undefined"==typeof window||!window.document),a=!o,u=n.include||n.atma&&n.atma.include,s=n.mask||n.atma&&n.atma.mask,f=n.Class||n.atma&&n.atma.Class;if(null==u&&a){var c=require("atma-libs/exports");u=c.include,s=c.mask,f=c.Class}var d=a?require("atma-formatter"):window.Formatter||s&&s.$utils.format;if(null==d)throw Error("atma-formatter is not preloaded.");var h,v,p;!function(){h=function(n,t){for(var e=t.split("."),r=e.length,l=-1;++l<r;){if(null==n)return null;n=n[e[l]]}return n},v=function(n,t,e){for(var r,l=t.split("."),i=l.length,o=-1;++o<i-1;)r=l[o],null==n[r]&&(n[r]={}),n=n[r];n[l[o]]=e},p=function(n,t){if(null==n&&(n={}),null==t)return n;var e,r;for(r in t)e=t[r],null!=e&&(n[r]=e);return n}}();var g;!function(){g=function(){var n=i.call(arguments);n.unshift("<i18n>"),console.log.apply(console,n)}}();var m,y;!function(){function e(n){return t(n,/language=(\w+)/,1)}m=function(){var r=e(n.location.search);return null==r&&(r=t(n.navigator.language,/^(\w+)/,1)),r=r.toLowerCase(),_(r)?r:L[0]},y=function(n){var t,r,l=n.url.indexOf("?");if(-1!==l){var i=n.url.substring(n.url);if(t=e(i),_(t))return t}if(r=n.headers["accept-language"],!r)return L[0];r=r.replace(/\s*/g,"").toLowerCase();for(var o,a,u=r.split(","),s=u.length,f=-1;++f<s;)if(a=u[f],o=a.indexOf(";"),t=-1===o?a:a.substring(0,o),_(t))return t;return L[0]}}();var w,_,x,b={},L=["en"];!function(n){_=function(n){return-1!==L.indexOf(n)},w=function(t,e){return null!=e?null==n[t]?void(n[t]=e):void p(n[t],e):void 0},x=function(n){var t=u&&u.route&&u.route.params;if(null!=t){t.support&&(L=t.support.split(","));var e=t.path;return e?o?void j.loadSingle({path:e}).done(n):void j.loadAll({path:e}).done(n):void(n&&n())}}}(b),function(){function n(n,t,e,r){return null==r?n:(null!=t?r.apply(n,t):e.push(r),n)}function t(n){n._done=null,n._fail=null,n._always=null}function r(n,t,e){if(null!=n){for(var r,l=n.length,i=-1;++i<l;)r=n[i],r&&r.apply(t,e);n.length=0}}function l(n,t){return function(){return n.apply(t,arguments)}}e.prototype={_isAsync:!0,_done:null,_fail:null,_always:null,_resolved:null,_rejected:null,defer:function(){this._rejected=null,this._resolved=null},resolve:function(){var n=this._done,e=this._always;return this._resolved=arguments,t(this),r(n,this,arguments),r(e,this,[this]),this},reject:function(){var n=this._fail,e=this._always;return this._rejected=arguments,t(this),r(n,this,arguments),r(e,this,[this]),this},resolveDelegate:function(){return l(this.resolve,this)},rejectDelegate:function(){return l(this.reject,this)},then:function(n,t){return this.done(n).fail(t)},done:function(t){return n(this,this._resolved,this._done||(this._done=[]),t)},fail:function(t){return n(this,this._rejected,this._fail||(this._fail=[]),t)},always:function(t){return n(this,this._rejected||this._resolved,this._always||(this._always=[]),t)}}}();var j;!function(){var t={};!function(){function n(n,t){return null==u&&o?void e(n,function(n){t(n)}):void u.ajax(n+"::Data").done(function(n){t(n.ajax.Data)})}function e(n,t){var e=new XMLHttpRequest;e.onload=function(){var n;try{n=JSON.parse(e.responseText)}catch(r){g("Should be json",r)}finally{t(n)}},e.open("get",n,!0),e.send()}t.file={single:function(t,e,r){n(e,function(n){w(t,n),r()})},many:function(n,t,e){function r(){--l<0&&e()}for(var l=t.length,i=l,o=-1;++o<i;)this.single(t[o],pathGlob.replace("%%",t[o]),r)}}}(),t.directory=function(t,e){var r=n.io||n.atma&&c.io,l=r&&r.glob;if(null==l){try{r=require("atma-io")}catch(i){throw g("run `npm i atma-io -save`"),i}l=r.glob}var o=[];l.readFiles(t).forEach(function(n){var t=n.uri.getName(),e=n.read();if("string"==typeof e)try{e=JSON.parse(e)}catch(r){return void g("Failed to load translations",n.uri.toLocalFile())}w(t,e)}),0===o.length&&g("No translations",t),e()};var r={};j={loadAll:function(n){function t(){--r<0&&o.resolve()}n.support&&(L=n.support);for(var r=L.length,l=r,i=-1;++i<l;)n.lang=L[i],logger.log(n),this.loadSingle(n).done(t);var o=new e;return o},loadSingle:function(n,l){n.support&&(L=n.support);var i=n.lang,o=n.path;if(null==i&&(i=a?y(l):m()),o){if(o.indexOf("%%")&&(o=o.replace("%%",i)),r[o])return r[o];var u=r[o]=new e;return t.file.single(i,o,u.resolveDelegate()),u}g("<Single Load: implemented `config.path` only>")}}}();var S;!function(n){function t(t){var e=n[t];null==e&&console.error("<localization> Translation is not defined for",t);var r=function(n){var t,r=null==e?n:e[n];return null==r&&(console.error("<localization> No translation for",n),r=n),1===arguments.length?r:(t=i.call(arguments),t[0]=r,d.apply(null,t))};return r.lang=t,r.extend=w,r}S=function(n){return null==e[n]?e[n]=t(n):e[n]};var e={}}(b),l.fromReq=function(n){if(n.$L)return n.$L;var t=y(n),e=S(t);return n.$L=e};var q=a?l:r;if(null!=s){var O,$;!function(){function n(n,e){return n.apply(null,t(e))}function t(n){var t=n[0].trim(),r=n[1],l=n[2],i=n[3];switch(t.charCodeAt(0)){case 34:case 39:return e(t,r,l,i)}var o=t.indexOf(",");return-1===o?[t]:(n=e(t.substring(o+1),r,l,i),n.unshift(t.substring(0,o)),n)}O=function(){return q.fromReq(ctx.req)(key,model)},$=function(){return n(q,arguments)};var e=s.Utils.Expression.evalStatements}(),s.registerUtil("L",a?O:$)}return q.loadSingle=j.loadSingle,a&&(q.middleware=function(n){return function(t,e,r){q.loadSingle(n,t).done(function(){q.fromReq(t),r()})}}),x(),q});